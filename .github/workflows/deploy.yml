name: Deploy to DigitalOcean App Platform

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest
    name: Deploy Universal Consultant Intelligence Platform
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      
    - name: Deploy to DigitalOcean App Platform
      uses: digitalocean/app_action@v2
      with:
        app_name: consultant-intelligence-platform
        token: ${{ secrets.DIGITALOCEAN_ACCESS_TOKEN }}
        app_spec_location: .do/app.yaml
        
    - name: Wait for deployment
      run: |
        echo "Deployment initiated successfully!"
        echo "Check deployment status at: https://cloud.digitalocean.com/apps"
        
    - name: Deployment summary
      run: |
        echo "🎉 Universal Consultant Intelligence Platform Deployment"
        echo "📦 App Name: consultant-intelligence-platform"
        echo "🌍 Region: NYC"
        echo "📂 Source: GitHub (IncomeStreamSurfer/context-engineering-intro)"
        echo "🚀 Auto-deploy: Enabled on main branch"
        echo ""
        echo "🔗 Access your app at the URL provided in the DigitalOcean dashboard"